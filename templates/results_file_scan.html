<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
   {% include 'includes/head.html' %}  
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div class="w-100 p-2">
            <div class="px-2">
                <h3 class="fs-5">File overview</h3>
                <div class="flex justify-content-between">
                    <div>
                        {% if detected %}
                        <h1 class="text-danger fs-5">Malicious</h1>
                        {%else%}
                        <h1 class="text-success fs-5">Clean</h1>
                        {% endif%}
                        <h2>{{filename}}</h2>
                        <p>Size: {{filesize}}</p>
                        <div class="flex">
                            {% for a,b in signaa.items() %}
                            <div class="border px-1 mr-1">
                                <span class="">{{a}}</span>
                                <span class="">
                                    {% if b %}
                                    <i class="fas fa-check-circle text-success"></i>
                                    {%else%}
                                    <i class="fas fa-window-close text-danger"></i>
                                    {%endif%}
                                </span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div>
                        <div
                            class="radial-progress"
                            style="--value: {{percentage}}; --size:6rem; --thickness:6px;"
                            role="progressbar">
                            {{percentage}}
                        </div>
                        <div class="text-center">{{totaldetected}} / {{totaldetectionrules}}</div>
                    </div>
                </div>
            </div>
            <div class="my-4">
                <p class="mb-1 border-top border-bottom p-2">Properties</p>
                <div class="w-100 px-2 py-2">
                    {% for hashes, value in Hashes_Data.items() %}
                    <div class="inline-flex w-100 my-1" style="gap:0.4rem;">
                        <span class="" style="flex: 0 1 10%;">{% print(hashes)%}</span>
                        <span class="" style="flex: 0 1 90%;">{% print( value ) %}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="my-4">
                <p class="mb-1 border-top border-bottom p-2">IPs,URLs,emails</p>
                <div class="w-100 px-2 py-2">
                    {%for ips in ip%}
                        <span class="border px-2 m-1">{% print(ips) %}</span>
                    {%endfor%}
                    {%for link in websiteLinks%}
                        <span class="border px-2 m-1">{% print(link) %}</span>
                    {%endfor%}                    
                    {%for emails in email%}
                        <span class="border px-2 m-1">{% print(emails) %}</span>
                    {%endfor%}
                </div>
            </div>
            <div class="my-4">
                <p class="mb-1 border-top border-bottom p-2">Portable exportable</p>
                <div class="w-100 px-2 py-2">
                    {% for a, b in peinfo.items() %}
                    <div class="inline-flex w-100 my-1" style="gap:0.4rem;">
                        <div class="" style="flex: 0 1 10%;">{% print(a)%}</div>
                        <div class="" style="flex: 0 1 90%;">
                            {% if b is iterable and b is not string %}
                                {% if b is mapping %}
                                    <!-- Dictionary -->
                                     {%for key,value in b.items()%}
                                        {%if value is iterable and value is not string%}
                                        <span>
                                            <span>
                                                {%print(key)%} : 
                                            </span>
                                            {%for innerItem in value%}
                                                <span class="border px-1">{%print(innerItem)%}</span>
                                            {%endfor%}
                                        </span>
                                        {%else%}
                                        <span>
                                            <span>
                                                {%print(key)%} : 
                                            </span> 
                                            <span class="border px-1">{%print(value)%}</span>
                                        </span>
                                        {%endif%}
                                     {%endfor%}
                                {%elif b is sequence%}
                                    <!-- Is arr -->
                                    {%for st in b%}
                                        {%if st is iterable and st is not string%}
                                            {%for key,value in st.items()%}
                                            <span>
                                                <span>
                                                    {%print(key)%} : 
                                                </span>
                                                <span class="border px-1">{%print(value)%}</span></span>
                                            {%endfor%}
                                        {%else%}
                                        <span class="border px-2 m-1">{% print(st) %}</span>
                                        {%endif%}
                                    {%endfor%}
                                 {%endif%}
                            {%else%}
                            <!-- normal string -->
                                {% print( b ) %}
                            {%endif%}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="my-4">
                <p class="mb-1 border-top border-bottom p-2">Yara rules detections</p>
                <div class="w-100 px-2 py-2">
                    {% for hashes, value in yaradetect.items() %}
                    <div class="inline-flex w-100 my-1" style="gap:0.4rem;">
                        <div class="" style="flex: 0 1 10%;">{% print(hashes)%}</div>
                        <div class="" style="flex: 0 1 90%;">
                            {%if value is sequence%}
                                {%for st in value%}
                                    <span class="border px-2 m-1">{% print(st) %}</span>
                                {%endfor%}
                            {%else%}
                            <span class="">{% print( value ) %}</span>
                            {%endif%}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <script src="" async defer></script>
    </body>
</html>